!function(){"use strict";var e={418:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var s,l,i=r(e),c=1;c<arguments.length;c++){for(var d in s=Object(arguments[c]))n.call(s,d)&&(i[d]=s[d]);if(t){l=t(s);for(var u=0;u<l.length;u++)a.call(s,l[u])&&(i[l[u]]=s[l[u]])}}return i}},408:function(e,t,n){var a=n(418),r=60103;t.Fragment=60107;if("function"==typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),o("react.portal"),t.Fragment=o("react.fragment"),o("react.strict_mode"),o("react.profiler"),o("react.provider"),o("react.context"),o("react.forward_ref"),o("react.suspense"),o("react.memo"),o("react.lazy")}"function"==typeof Symbol&&Symbol.iterator;function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},i={};function c(e,t,n){this.props=e,this.context=t,this.refs=i,this.updater=n||l}function d(){}function u(e,t,n){this.props=e,this.context=t,this.refs=i,this.updater=n||l}c.prototype.isReactComponent={},c.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(s(85));this.updater.enqueueSetState(this,e,t,"setState")},c.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},d.prototype=c.prototype;var m=u.prototype=new d;m.constructor=u,a(m,c.prototype),m.isPureReactComponent=!0;var p=null,v=Object.prototype.hasOwnProperty,f={key:!0,ref:!0,__self:!0,__source:!0};t.createElement=function(e,t,n){var a,o={},s=null,l=null;if(null!=t)for(a in void 0!==t.ref&&(l=t.ref),void 0!==t.key&&(s=""+t.key),t)v.call(t,a)&&!f.hasOwnProperty(a)&&(o[a]=t[a]);var i=arguments.length-2;if(1===i)o.children=n;else if(1<i){for(var c=Array(i),d=0;d<i;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===o[a]&&(o[a]=i[a]);return{$$typeof:r,type:e,key:s,ref:l,props:o,_owner:p}}},294:function(e,t,n){e.exports=n(408)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}!function(){var e=n(294);const{format:t}=wp.date;function a(e){let{start:n,finish:a}=e;if(!n)return null;const r="g:i A",o=t(r,n),s=!!a&&t(r,a);return`At ${o}${s?" until "+s:""}`}const r=e=>{let{start:n,finish:a}=e;if(!n)return null;const r="l j F",o=t(r,n),s=t("Y",n),l=!(!a||t("l F j Y",a)==t("l F j Y",n))&&a&&t(r,a),i=!(!a||t("Y",a)==t("Y",n))&&t("Y",a);return`${o}${i?", "+s:""}${l?" to ":""}${l||""}${i?", "+i:", "+s}`},o="_snt_event_start",s="_snt_event_finish",l="_snt_event_de_facto_finish",i="_snt_event_date_string",c="_snt_event_time_string",d="_snt_event_ignore_time",u="_snt_event_details",m=["core/paragraph","core/heading","core/list"];function p(e){return e?e.slice(0,-8).concat("23:59:59"):""}function v(e,t,n){const{start:d,finish:u,deFactoFinish:m,meta:v,setMeta:f}=n;if("start"==t){const t=r({start:e,finish:u}),n=a({start:e,finish:u});f({...v,[o]:e,[l]:u?m:p(e),[i]:t,[c]:n})}else if("finish"==t){const t=d?r({start:d,finish:e}):"",n=d?a({start:d,finish:e}):"";f({...v,[s]:e,[l]:p(e),[i]:t,[c]:n})}}function f(e,t,n){let{meta:a,setMeta:r}=n;const o=Object.assign({},a[u],{[t]:e});r({...a,[u]:o})}function h(e,t){t({...e,[o]:"",[s]:"",[l]:"",[i]:"",[c]:"",[d]:!1})}const{__:__}=wp.i18n,{InspectorControls:E,BlockControls:g}=wp.blockEditor,{DateTimePicker:b,PanelBody:_,SelectControl:y,TextControl:w,Button:k,ToolbarGroup:S,ToolbarButton:O,ToggleControl:C}=wp.components;function j(t){let{metaData:n}=t;const{start:r,finish:o,ignoreTime:s,details:l,meta:i,setMeta:u}=n;return(0,e.createElement)(E,null,(0,e.createElement)(_,{title:__("Event Settings","sntEvents"),initialOpen:!1,icon:"admin-settings",className:"snt-events-event-settings"},(0,e.createElement)("h3",null,"Ignore Event Times"),(0,e.createElement)("p",null,__("Use this switch to ignore start and finish times, so that your events will have dates only. Daily opening times can be added in the event block, under the dates.","sntEvents")),(0,e.createElement)(C,{label:__("Ignore event times?","sntEvents"),help:__(s?"Ignore times, event has dates only.":"Event has dates and times.","sntEvents"),checked:s,onChange:()=>function(e){let{start:t,finish:n,ignoreTime:r,meta:o,setMeta:s}=e;const l=a({start:t,finish:n});s({...o,[d]:!r,[c]:r?l:""})}(n)}),(0,e.createElement)("h3",null,"Clear Dates and Times"),(0,e.createElement)(k,{isSecondary:!0,label:__("Clear dates and times","sntEvents"),icon:__("dismiss","sntEvents"),className:"snt-clear-meta-button",onClick:()=>h(i,u)},__(" Clear dates","sntEvents"))),(0,e.createElement)(_,{title:__("Events Schema","sntEvents"),initialOpen:!1,icon:"editor-code",className:"snt-events-event-schema"},(0,e.createElement)("p",null,"These settings are used to set up the"," ",(0,e.createElement)("a",{href:"https://developers.google.com/search/docs/data-types/event",target:"_blank"},"Event schema data")," ","(i.e. will be hidden), and will not appear within the events block. To add an address, performers and other details that will be visible inside the event block, add paragraph, heading, or list blocks to bottom of the event block."),(0,e.createElement)("h3",null,"Status"),(0,e.createElement)(y,{label:__("Select an events status:","sntEvents"),value:l.status,onChange:e=>f(e,"status",n),options:[{value:null,label:"Select a status"},{value:"EventScheduled",label:"Scheduled as normal"},{value:"EventRescheduled",label:"Rescheduled"},{value:"EventMovedOnline",label:"Moved online"},{value:"EventPostponed",label:"Postponed"},{value:"EventCancelled",label:"Cancelled"}]}),(0,e.createElement)("h3",null,"Location"),(0,e.createElement)(y,{label:__("Select a location type:","sntEvents"),value:l.attendance_mode,onChange:e=>f(e,"attendance_mode",n),options:[{value:null,label:"Select a location type"},{value:"OfflineEventAttendanceMode",label:"Real-world venue"},{value:"OnlineEventAttendanceMode",label:"Online"},{value:"MixedEventAttendanceMode",label:"Mixed (real-world and online)"}]}),("OfflineEventAttendanceMode"===l.attendance_mode||"MixedEventAttendanceMode"===l.attendance_mode)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h4",null,"Venue Location"),(0,e.createElement)(w,{label:__("Venue name","sntEvents"),value:l.venue_location_name||"",placeholder:__("Venue name...","sntEvents"),onChange:e=>f(e,"venue_location_name",n)}),(0,e.createElement)(w,{label:__("Venue Address","sntEvents"),value:l.venue_location_address||"",placeholder:__("Venue address...","sntEvents"),onChange:e=>f(e,"venue_location_address",n)})),("OnlineEventAttendanceMode"===l.attendance_mode||"MixedEventAttendanceMode"===l.attendance_mode)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h3",null,"Online Location"),(0,e.createElement)(w,{label:__("Online location name","sntEvents"),value:l.online_location_name||"",placeholder:__("Website name...","sntEvents"),onChange:e=>f(e,"online_location_name",n)}),(0,e.createElement)(w,{label:__("Online location (paste full URL including https://)","sntEvents"),value:l.online_location_url||"",placeholder:__("https://...","sntEvents"),onChange:e=>f(e,"online_location_url",n)})),(0,e.createElement)("h3",null,"Performers"),(0,e.createElement)(w,{label:__("A comma separated list of performers","sntEvents"),value:l.performers||"",placeholder:__("Comma separated list...","sntEvents"),onChange:e=>f(e,"performers",n)})),(0,e.createElement)(_,{title:__("Start Date/Time","sntEvents"),initialOpen:!1,icon:"calendar-alt"},(0,e.createElement)(b,{currentDate:r,onChange:e=>v(e,"start",n),is12Hour:!1})),(0,e.createElement)(_,{title:__("Finish Date/Time","sntEvents"),initialOpen:!1,icon:"calendar-alt"},(0,e.createElement)(b,{currentDate:o,onChange:e=>v(e,"finish",n),is12Hour:!1})))}function P(t){let{metaData:{meta:n,setMeta:a}}=t;return(0,e.createElement)(g,null,(0,e.createElement)(S,null,(0,e.createElement)(O,{label:__("Clear dates","sntEvents"),icon:"dismiss",className:"snt-clear-meta-button",onClick:()=>h(n,a)})))}const M=function(t){let{start:n,finish:a}=t;const r=Date.parse(n),o=Date.parse(a);return r||o?o&&!r?(0,e.createElement)(T,{className:"event-date-warning"},"The event must have a start date/time"):o<r?(0,e.createElement)(T,{className:"event-date-warning"},"The finish date/time must be after the finish date/time."):void 0:(0,e.createElement)(T,{className:"event-date-instruction"},"Enter event date and time.")};function T(t){let{className:n,children:a}=t;return(0,e.createElement)("div",{className:n},(0,e.createElement)("span",{className:"dashicons dashicons-info-outline"})," ",a)}const{InnerBlocks:D}=wp.blockEditor;function N(t){let{metaData:{start:n,finish:a,ignoreTime:r,dateString:o,timeString:s}}=t;const l=Date.parse(n),i=Date.parse(a);return(0,e.createElement)("div",{className:"event-details-wrapper"},(0,e.createElement)("p",{className:"event-details-title"},"Event Details"),(!n||i<l)&&(0,e.createElement)(M,{start:n,finish:a}),(0,e.createElement)("p",{className:"event-detail-date"},o),!r&&(0,e.createElement)("p",{className:"event-details-time"},s),(0,e.createElement)(D,{allowedBlocks:m}))}const{useSelect:x}=wp.data,{useEntityProp:A}=wp.coreData,{select:F,dispatch:B}=wp.data;function I(){const e=parseInt(from_php_object.events_cat_ID),t=(F("core/editor").getEditedPostAttribute("categories")||[]).filter((e=>1!=e)).concat([e]);return B("core/editor").editPost({categories:t}),()=>{const e=parseInt(from_php_object.events_cat_ID),t=(F("core/editor").getEditedPostAttribute("categories")||[]).filter((t=>t!=e));B("core/editor").editPost({categories:t.length>0?t:[1]}),B("core/editor").editPost({meta:{[o]:"",[s]:"",[l]:"",[d]:!1,[i]:"",[c]:""}})}}const{select:R,dispatch:$}=wp.data,q=wp.data.dispatch("core/notices").createErrorNotice,U=wp.data.dispatch("core/notices").removeNotice,{useEffect:V}=wp.element,{useBlockProps:Y}=wp.blockEditor,{InnerBlocks:L}=wp.blockEditor,{useBlockProps:H}=wp.blockEditor,{registerBlockType:z}=wp.blocks,{__:G}=wp.i18n;"post"===from_php_object.post_type&&z("snt/events-block",{apiVersion:2,title:G("SNT Events Block","sntEvents"),icon:"calendar-alt",category:"text",supports:{multiple:!1},edit:function(){const t=Y(),n=(()=>{const e=x((e=>e("core/editor").getCurrentPostType()),[]),[t,n]=A("postType",e,"meta");return{start:t[o]||"",finish:t[s]||"",deFactoFinish:t[l]||"",ignoreTime:t[d]||!1,dateString:t[i]||"",timeString:t[c]||"",details:t[u]||{},meta:t,setMeta:n}})();return V(I,[]),V((()=>(function(e){const t=R("core/notices").getNotices();e.start?e.start&&($("core/editor").unlockPostSaving("noStartMeta"),U("snt-events-block-missing-start")):(console.warn("The event need a start time."),$("core/editor").lockPostSaving("noStartMeta"),t.some((e=>"snt-events-block-missing-start"===e.id))||q("The Events Block needs to have a start date",{id:"snt-events-block-missing-start"}))}(n),()=>{$("core/editor").unlockPostSaving("noStartMeta"),U("snt-events-block-missing-start")})),[n.start]),(0,e.createElement)("div",t,(0,e.createElement)(j,{metaData:n}),(0,e.createElement)(P,{metaData:n}),(0,e.createElement)(N,{metaData:n}))},save:()=>{const t=H.save();return(0,e.createElement)("div",t,(0,e.createElement)(L.Content,null))}})}()}();